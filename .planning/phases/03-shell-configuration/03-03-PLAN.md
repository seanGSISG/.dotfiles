---
phase: 03-shell-configuration
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - dot_config/zsh/aliases/aliases-git.zsh
  - dot_config/zsh/aliases/aliases-docker.zsh
  - dot_config/zsh/aliases/aliases-navigation.zsh
  - dot_config/zsh/aliases/aliases-utilities.zsh
  - dot_config/zsh/aliases/aliases-dev.zsh
  - dot_config/zsh/aliases/aliases-system.zsh
  - dot_config/zsh/functions.zsh
autonomous: true

must_haves:
  truths:
    - "308-line aliases file is audited for zsh compatibility and split into 6 category files in dot_config/zsh/aliases/"
    - "Zsh compatibility audit confirms: no bash-only array indexing, no bash-only declarations, POSIX-compatible syntax"
    - "All aliases use POSIX-compatible syntax (no zsh-specific array indexing)"
    - "alias-help function displays colorized categorized alias list"
    - "'?' and 'halp' aliases invoke alias-help"
    - "All aliases work in both zsh and bash (no shell-specific syntax)"
    - "No hardcoded /home/vscode paths in any alias file"
  artifacts:
    - path: "dot_config/zsh/aliases/aliases-git.zsh"
      provides: "Git aliases (g, gs, ga, gc, gp, glog, etc.)"
      contains: "alias gs="
    - path: "dot_config/zsh/aliases/aliases-docker.zsh"
      provides: "Docker aliases (d, dc, dcu, dcd, dps, etc.)"
      contains: "alias dc="
    - path: "dot_config/zsh/aliases/aliases-navigation.zsh"
      provides: "Navigation aliases (.., ..., mkcd)"
      contains: "alias ..="
    - path: "dot_config/zsh/aliases/aliases-utilities.zsh"
      provides: "Utility aliases (ports, path, myip, weather, cp, mv, etc.)"
      contains: "alias ports="
    - path: "dot_config/zsh/aliases/aliases-dev.zsh"
      provides: "Development aliases (python, testing, node, code quality)"
      contains: "alias py="
    - path: "dot_config/zsh/aliases/aliases-system.zsh"
      provides: "System/tool aliases (claude, wezterm, tmux, azure, editor, misc)"
      contains: "alias cc="
    - path: "dot_config/zsh/functions.zsh"
      provides: "alias-help function and custom shell functions"
      contains: "alias-help()"
  key_links:
    - from: "dot_config/zsh/functions.zsh"
      to: "dot_config/zsh/aliases/"
      via: "alias-help reads alias files with grep"
      pattern: "aliases-\\*\\.zsh"
---

<objective>
Audit the existing 308-line aliases file for zsh compatibility, split it into 6 categorized files, and create the alias help system in functions.zsh.

Purpose: Modular alias files improve maintainability, allow category-level management, and enable both zsh and bash to source the same files. The help system makes aliases discoverable.

Output: 6 alias category files in dot_config/zsh/aliases/ plus functions.zsh with the alias-help system.
</objective>

<execution_context>
@/home/vscode/.claude/get-shit-done/workflows/execute-plan.md
@/home/vscode/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-shell-configuration/03-RESEARCH.md
@.planning/phases/03-shell-configuration/03-CONTEXT.md

**Critical source file to migrate:**
Read: ~/.oh-my-bash/custom/aliases/personal.aliases.sh (308 lines)
This is the ONLY source of truth for aliases. Every alias must be accounted for.

Chezmoi source directory: ~/.dotfiles
Chezmoi naming: dot_config/zsh/aliases/aliases-git.zsh maps to ~/.config/zsh/aliases/aliases-git.zsh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Audit aliases for zsh compatibility and split into 6 category files</name>
  <files>
    dot_config/zsh/aliases/aliases-git.zsh
    dot_config/zsh/aliases/aliases-docker.zsh
    dot_config/zsh/aliases/aliases-navigation.zsh
    dot_config/zsh/aliases/aliases-utilities.zsh
    dot_config/zsh/aliases/aliases-dev.zsh
    dot_config/zsh/aliases/aliases-system.zsh
  </files>
  <action>
**Step 1: Read the existing aliases file**
Read `~/.oh-my-bash/custom/aliases/personal.aliases.sh` (308 lines) to get all current aliases.

**Step 2: Audit for zsh compatibility**
Check each alias/function for zsh compatibility issues:
- Array indexing: zsh uses 1-based, bash uses 0-based (check any `$1`, `$2` in functions - these are fine, they're positional params not array indices)
- `alias -- -='cd -'`: The double-dash syntax works in both shells
- All simple `alias x='command'` definitions work identically in both shells
- Functions using `local`, `if/then/else`, `[ -z "$1" ]` work in both shells
- Docker `--format "table {{.Names}}"` uses double-braces which could conflict with chezmoi templates if in .tmpl files, but these are NOT template files so no issue

**Step 3: Split into 6 files with these exact categorizations:**

**aliases-navigation.zsh** (from lines 141-146):
```zsh
# Navigation aliases
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias -- -='cd -'
```
Note: `mkcd()` function moves to functions.zsh (it's a function, not an alias).

**aliases-docker.zsh** (from lines 149-163):
```zsh
# Docker aliases
alias d='docker'
alias dc='docker compose'
alias dcu='docker compose up -d'
alias dcd='docker compose down'
alias dcl='docker compose logs -f'
alias dcb='docker compose build'
alias dcr='docker compose restart'
alias dps='docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"'
alias dpsa='docker ps -a --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"'
alias dprune='docker system prune -af --volumes'

# Docker functions
dex() { docker exec -it "$1" "${2:-sh}"; }
dsh() { docker exec -it "$1" sh; }
dbash() { docker exec -it "$1" bash; }
dlog() { docker logs -f "$1"; }
```

**aliases-git.zsh** (from lines 166-185):
```zsh
# Git aliases
alias g='git'
alias gs='git status'
alias ga='git add'
alias gaa='git add --all'
alias gc='git commit'
alias gcm='git commit -m'
alias gp='git push'
alias gpl='git pull'
alias gco='git checkout'
alias gcb='git checkout -b'
alias gb='git branch'
alias gba='git branch -a'
alias glog='git log --oneline -15'
alias glg='git log --graph --oneline --decorate -15'
alias gd='git diff'
alias gds='git diff --staged'
alias gst='git stash'
alias gstp='git stash pop'
alias gundo='git reset HEAD~1 --soft'
alias gwip='git add -A && git commit -m "WIP"'
```

**aliases-dev.zsh** (from lines 187-214 -- python, testing, code quality, node):
```zsh
# Python
alias py='python3'
alias pip='pip3'
alias venv='python3 -m venv .venv'
alias va='source .venv/bin/activate'
alias vd='deactivate'
alias pipr='pip install -r requirements.txt'
alias uvs='uv sync'
alias uvr='uv run'

# Testing
alias pt='pytest'
alias ptv='pytest -v'
alias ptc='pytest --cov'
alias ptvv='pytest -vv'

# Code quality
alias ruffc='ruff check .'
alias rufff='ruff format .'

# Node/NPM
alias ni='npm install'
alias nid='npm install --save-dev'
alias nr='npm run'
alias nrs='npm run start'
alias nrd='npm run dev'
alias nrb='npm run build'
alias nrt='npm run test'
```

**aliases-utilities.zsh** (from lines 217-242):
```zsh
# Utilities
alias ports='ss -tulnp 2>/dev/null || netstat -tulnp 2>/dev/null || lsof -i -P -n | grep LISTEN'
alias path='echo $PATH | tr ":" "\n"'
alias myip='curl -s ifconfig.me'
alias localip='hostname -I | awk "{print \$1}"'
alias weather='curl -s "wttr.in?format=3"'
alias cls='clear'
alias h='history'
alias hg='history | grep'

# Editor shortcut
alias e='${EDITOR:-code}'

# Quick file operations (interactive safety)
alias cp='cp -iv'
alias mv='mv -iv'
alias rm='rm -iv'
alias mkdir='mkdir -pv'

# List improvements
alias ll='ls -lah'
alias la='ls -A'
alias l='ls -CF'
```

Note: The `reload` alias is deliberately OMITTED here. It was `source ~/.bashrc` which is bash-specific. A proper reload alias will be added to functions.zsh that detects the current shell.

Note: `cheat()` function moves to functions.zsh.

**aliases-system.zsh** (from lines 5-6, 244-307 -- claude, azure, wezterm, tmux, misc):
```zsh
# Claude Code
alias cc='claude'
alias ccd='claude --dangerously-skip-permissions'

# Azure Key Vault (GSI)
alias az-login='az login --tenant 07e978d3-49bb-4f6c-948d-2908f2e20014'

# Quick tmux helpers
alias tn='tmux new -s'
alias ta='tmux attach -t'
alias tl='tmux list-sessions'
alias tk='tmux kill-session -t'
```

The following FUNCTIONS from the system category move to functions.zsh:
- `az-secret()`, `az-secrets-list()` (Azure functions)
- `cct()`, `ccr()`, `ccb()` (WezTerm + Claude functions)
- `ccv()`, `cch()` (Tmux + Claude functions)

**Aliases deliberately REMOVED:**
- `alias lokka='cd ~/projects/gsisg-lokka && ccd'` -- project-specific, uses hardcoded path (line 307)
- `alias prefect="cd /home/vscode/workspace/prefect-antig && source .venv/bin/activate"` -- from .bashrc line 187, hardcoded path, project-specific
- `alias reload='source ~/.bashrc'` -- bash-specific, replaced by shell-aware function

**REQUIREMENT ALIAS-03 -- New useful aliases to add** based on current toolset:
Add to appropriate files:
- In aliases-git.zsh: `alias gca='git commit --amend'` and `alias gcane='git commit --amend --no-edit'`
- In aliases-dev.zsh: `alias uvp='uv pip'` and `alias bun='bun'` (already available), `alias br='bun run'`, `alias bi='bun install'`
- In aliases-utilities.zsh: `alias t='tail -f'` and `alias df='df -h'` and `alias du='du -sh'`

Each file must have a header comment identifying its category. All files use POSIX-compatible alias syntax. No hardcoded paths.
  </action>
  <verify>
Run: `ls ~/.dotfiles/dot_config/zsh/aliases/` should show exactly 6 files.
Run: `grep -r '/home/vscode' ~/.dotfiles/dot_config/zsh/aliases/` should return nothing.
Run: `grep -c '^alias ' ~/.dotfiles/dot_config/zsh/aliases/*.zsh | awk -F: '{sum+=$2} END {print sum}'` should show total alias count (expect ~60-70).
Run: `grep 'oh-my\|OMZ\|OMB\|Oh My' ~/.dotfiles/dot_config/zsh/aliases/*.zsh` should return nothing.
ALIAS-01 audit verification (zsh compatibility):
Run: `grep -rE '\$\{[a-zA-Z]+\[0\]\}' ~/.dotfiles/dot_config/zsh/aliases/*.zsh` should return nothing (no bash 0-based array indexing).
Run: `grep -rE 'declare -a|declare -A' ~/.dotfiles/dot_config/zsh/aliases/*.zsh` should return nothing (no bash-only array declarations).
Run: `grep -rE '\[\[.*=~' ~/.dotfiles/dot_config/zsh/aliases/*.zsh` â€” regex matching is fine (both shells support it), but verify no bash-only regex syntax.
Run: `grep -rE 'source |\.\ ' ~/.dotfiles/dot_config/zsh/aliases/*.zsh` should return nothing (aliases shouldn't source files).
  </verify>
  <done>6 alias category files created with all aliases from existing 308-line file properly categorized and audited for zsh compatibility (ALIAS-01). Audit verified: no bash-specific array indexing, no bash-only declarations, all syntax POSIX-compatible for bash sharing. New useful aliases added per ALIAS-03. No hardcoded paths, no project-specific aliases, no Oh My Zsh/Bash references.</done>
</task>

<task type="auto">
  <name>Task 2: Create functions.zsh with alias-help system and shell functions</name>
  <files>dot_config/zsh/functions.zsh</files>
  <action>
Create `~/.dotfiles/dot_config/zsh/functions.zsh` with shell functions and the alias help system.

**Section 1: Alias help system (ALIAS-04)**

Create a colorized alias-help function that dynamically reads from the alias category files:

```zsh
# Color definitions (work in both zsh and bash)
BLUE='\033[0;34m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
CYAN='\033[0;36m'
RESET='\033[0m'

alias-help() {
  printf "\n${BLUE}%s${RESET}\n" "======================================="
  printf "${GREEN}%s${RESET}\n" "  Available Aliases"
  printf "${BLUE}%s${RESET}\n\n" "======================================="

  for category_file in "$HOME/.config/zsh/aliases"/aliases-*.zsh; do
    [ -r "$category_file" ] || continue
    local category
    category=$(basename "$category_file" .zsh | sed 's/aliases-//' | tr '[:lower:]' '[:upper:]')
    printf "${YELLOW}>>> %s${RESET}\n" "$category"

    grep "^alias " "$category_file" | while IFS= read -r line; do
      local name value
      name=$(echo "$line" | sed "s/^alias //" | cut -d= -f1)
      value=$(echo "$line" | cut -d= -f2- | sed "s/^'//" | sed "s/'$//" | sed 's/^"//' | sed 's/"$//')
      printf "  ${CYAN}%-16s${RESET} %s\n" "$name" "$value"
    done
    echo ""
  done

  printf "${YELLOW}>>> %s${RESET}\n" "QUICK REFERENCE"
  printf "  ${CYAN}%-16s${RESET} %s\n" "z <query>" "Jump to directory (zoxide)"
  printf "  ${CYAN}%-16s${RESET} %s\n" "Ctrl+R" "Fuzzy search history (fzf)"
  printf "  ${CYAN}%-16s${RESET} %s\n" "Ctrl+T" "Fuzzy find files (fzf)"
  printf "  ${CYAN}%-16s${RESET} %s\n" "Alt+C" "Fuzzy cd into subdirs (fzf)"
  echo ""
}

alias '?'='alias-help'
alias halp='alias-help'
```

**Section 2: Navigation function**

```zsh
# mkdir + cd combined
mkcd() { mkdir -p "$1" && cd "$1"; }
```

**Section 3: Utility functions**

```zsh
# Cheatsheet lookup
cheat() { curl -s "cheat.sh/$1"; }

# Shell-aware reload
reload() {
  if [ -n "$ZSH_VERSION" ]; then
    source "$HOME/.zshrc"
  elif [ -n "$BASH_VERSION" ]; then
    source "$HOME/.bashrc"
  fi
}
```

**Section 4: Azure Key Vault functions** (from existing aliases lines 247-262)

```zsh
# Azure Key Vault (GSI)
az-secret() {
  local vault="${AZ_KEYVAULT:-kv-idm-webapp-prod}"
  if [ -z "$1" ]; then
    echo "Usage: az-secret <secret-name> [vault-name]"
    echo "Default vault: $vault (set AZ_KEYVAULT to change)"
    return 1
  fi
  [ -n "$2" ] && vault="$2"
  az keyvault secret show --vault-name "$vault" --name "$1" --query "value" -o tsv
}

az-secrets-list() {
  local vault="${AZ_KEYVAULT:-kv-idm-webapp-prod}"
  [ -n "$1" ] && vault="$1"
  az keyvault secret list --vault-name "$vault" -o table
}
```

**Section 5: WezTerm + Claude functions** (from existing aliases lines 265-292)

```zsh
# WezTerm + Claude (uses WSL interop)
cct() {
  local prompt="$*"
  if [ -n "$prompt" ]; then
    wezterm.exe cli spawn --cwd "$(pwd)" -- bash -lc "claude --dangerously-skip-permissions \"$prompt\""
  else
    wezterm.exe cli spawn --cwd "$(pwd)" -- bash -lc "claude --dangerously-skip-permissions"
  fi
}

ccr() {
  local prompt="$*"
  if [ -n "$prompt" ]; then
    wezterm.exe cli split-pane --right --cwd "$(pwd)" -- bash -lc "claude --dangerously-skip-permissions \"$prompt\""
  else
    wezterm.exe cli split-pane --right --cwd "$(pwd)" -- bash -lc "claude --dangerously-skip-permissions"
  fi
}

ccb() {
  local prompt="$*"
  if [ -n "$prompt" ]; then
    wezterm.exe cli split-pane --bottom --cwd "$(pwd)" -- bash -lc "claude --dangerously-skip-permissions \"$prompt\""
  else
    wezterm.exe cli split-pane --bottom --cwd "$(pwd)" -- bash -lc "claude --dangerously-skip-permissions"
  fi
}
```

**Section 6: Tmux + Claude functions** (from existing aliases lines 295-297)

```zsh
# Tmux + Claude
ccv() { tmux split-window -h "claude --dangerously-skip-permissions $*"; }
cch() { tmux split-window -v "claude --dangerously-skip-permissions $*"; }
```

**Important:** All functions use POSIX-compatible syntax so they work when bash sources this file. No zsh-specific syntax in functions (no `${array[1]}` or `[[ ]]` that bash doesn't support -- actually bash supports `[[ ]]` too, so that's fine). Use `[ ]` where possible for maximum compatibility, but `[[ ]]` is acceptable since bash supports it.
  </action>
  <verify>
Run: `grep 'alias-help' ~/.dotfiles/dot_config/zsh/functions.zsh` confirms help function exists.
Run: `grep "alias '?'" ~/.dotfiles/dot_config/zsh/functions.zsh` confirms ? alias.
Run: `grep 'mkcd\|cheat\|reload' ~/.dotfiles/dot_config/zsh/functions.zsh` confirms utility functions.
Run: `grep '/home/vscode' ~/.dotfiles/dot_config/zsh/functions.zsh` should return nothing.
Run: `grep -c '()' ~/.dotfiles/dot_config/zsh/functions.zsh` should show ~10+ function definitions.
  </verify>
  <done>functions.zsh contains alias-help system with colorized output reading from category files, ? and halp aliases, mkcd, cheat, reload, Azure functions, WezTerm+Claude functions, and Tmux+Claude functions. All functions work in both zsh and bash. No hardcoded paths.</done>
</task>

</tasks>

<verification>
1. `ls ~/.dotfiles/dot_config/zsh/aliases/` shows exactly 6 files (aliases-git.zsh, aliases-docker.zsh, aliases-navigation.zsh, aliases-utilities.zsh, aliases-dev.zsh, aliases-system.zsh)
2. `ls ~/.dotfiles/dot_config/zsh/functions.zsh` exists
3. `grep -r '/home/vscode' ~/.dotfiles/dot_config/zsh/aliases/ ~/.dotfiles/dot_config/zsh/functions.zsh` returns nothing
4. Every alias from original personal.aliases.sh is accounted for (migrated or deliberately removed with reason)
5. `grep 'alias-help' ~/.dotfiles/dot_config/zsh/functions.zsh` confirms help system
6. `grep "alias '?'" ~/.dotfiles/dot_config/zsh/functions.zsh` confirms help aliases
</verification>

<success_criteria>
- 6 alias category files created with proper categorization
- All existing aliases accounted for (migrated, improved, or deliberately removed)
- New useful aliases added per ALIAS-03 (git, dev, utility additions)
- alias-help function reads category files dynamically and displays colorized output
- ? and halp aliases work
- All functions (azure, wezterm, tmux, utility) migrated to functions.zsh
- No hardcoded paths, POSIX-compatible syntax throughout
</success_criteria>

<output>
After completion, create `.planning/phases/03-shell-configuration/03-03-SUMMARY.md`
</output>
